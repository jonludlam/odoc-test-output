<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="generator" content=
"HTML Tidy for HTML5 for Linux version 5.2.0" />
<title>Core_kernel__Command
(core_kernel.Core_kernel__Command)</title>
<link rel="stylesheet" href="../../odoc.css" />
<meta charset="utf-8" />
<meta name="viewport" content=
"width=device-width,initial-scale=1.0" />
<script src="../../highlight.pack.js">
</script>
<script>
<![CDATA[
hljs.initHighlightingOnLoad();
]]>
</script>
</head>
<body>
<div class="content">
<header>
<nav><a href="../index.html">Up</a> – <a href=
"../index.html">core_kernel</a> » Core_kernel__Command</nav>
<h1>Module <code>Core_kernel__Command</code></h1>
</header>
<div>
<div class="spec include">
<div class="doc">
<dl>
<dt class="spec module" id="module-Arg_type"><a href=
"#module-Arg_type" class="anchor"></a><code><span class=
"keyword">module</span> <a href="Arg_type/index.html">Arg_type</a>
: <span class="keyword">sig</span> ... <span class=
"keyword">end</span></code></dt>
<dd>
<p>Argument types.</p>
</dd>
</dl>
<dl>
<dt class="spec module" id="module-Flag"><a href="#module-Flag"
class="anchor"></a><code><span class="keyword">module</span>
<a href="Flag/index.html">Flag</a> : <span class=
"keyword">sig</span> ... <span class=
"keyword">end</span></code></dt>
<dd>
<p>Command-line flag specifications.</p>
</dd>
</dl>
<dl>
<dt class="spec module" id="module-Anons"><a href="#module-Anons"
class="anchor"></a><code><span class="keyword">module</span>
<a href="Anons/index.html">Anons</a> : <span class=
"keyword">sig</span> ... <span class=
"keyword">end</span></code></dt>
<dd>
<p>Anonymous command-line argument specification.</p>
</dd>
</dl>
<dl>
<dt class="spec module" id="module-Param"><a href="#module-Param"
class="anchor"></a><code><span class="keyword">module</span>
<a href="Param/index.html">Param</a> : <span class=
"keyword">sig</span> ... <span class=
"keyword">end</span></code></dt>
<dd>
<p>Command-line parameter specification.</p>
</dd>
</dl>
<div class="spec module" id="module-Let_syntax"><a href=
"#module-Let_syntax" class="anchor"></a><code><span class=
"keyword">module</span> <a href=
"Let_syntax/index.html">Let_syntax</a> : <span class=
"keyword">sig</span> ... <span class="keyword">end</span>
<span class="keyword">with</span> <span class="keyword">type</span>
'a <a href="Let_syntax/index.html#type-t">t</a> := <span class=
"type-var">'a</span> <a href=
"Param/index.html#type-t">Param.t</a></code></div>
<dl>
<dt class="spec module" id="module-Spec"><a href="#module-Spec"
class="anchor"></a><code><span class="keyword">module</span>
<a href="Spec/index.html">Spec</a> : <span class=
"keyword">sig</span> ... <span class=
"keyword">end</span></code></dt>
<dd>
<p>The old interface for command-line specifications -- <b>Do Not
Use</b>.</p>
</dd>
</dl>
<dl>
<dt class="spec type" id="type-t"><a href="#type-t" class=
"anchor"></a><code><span class="keyword">type</span> t</code></dt>
<dd>
<p>Commands which can be combined into a hierarchy of
subcommands.</p>
</dd>
</dl>
<dl>
<dt class="spec type" id="type-basic_spec_command"><a href=
"#type-basic_spec_command" class="anchor"></a><code><span class=
"keyword">type</span> ('main, 'result) basic_spec_command</code>
<code>= summary:<a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>
<span>-&gt;</span> ?⁠readme:(<a href=
"../Core_kernel__/Import/index.html#type-unit">Core_kernel__.Import.unit</a>
<span>-&gt;</span> <a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>)
<span>-&gt;</span> (<span class=
"type-var">'main</span>,&nbsp;<a href=
"../Core_kernel__/Import/index.html#type-unit">Core_kernel__.Import.unit</a>
<span>-&gt;</span> <span class="type-var">'result</span>) <a href=
"Spec/index.html#type-t">Spec.t</a> <span>-&gt;</span> <span class=
"type-var">'main</span> <span>-&gt;</span> <a href=
"index.html#type-t">t</a></code></dt>
</dl>
<dl>
<dt class="spec value" id="val-basic_spec"><a href=
"#val-basic_spec" class="anchor"></a><code><span class=
"keyword">val</span> basic_spec : (<span class=
"type-var">'main</span>,&nbsp;<a href=
"../Core_kernel__/Import/index.html#type-unit">Core_kernel__.Import.unit</a>)
<a href=
"index.html#type-basic_spec_command">basic_spec_command</a></code></dt>
<dd>
<p><code>basic_spec ~summary ?readme spec main</code> is a basic
command that executes a function <code>main</code> which is passed
parameters parsed from the command line according to
<code>spec</code>. <code>summary</code> is to contain a short
one-line description of its behavior. <code>readme</code> is to
contain any longer description of its behavior that will go on that
command's help screen.</p>
</dd>
</dl>
<dl>
<dt class="spec type" id="type-basic_command"><a href=
"#type-basic_command" class="anchor"></a><code><span class=
"keyword">type</span> 'result basic_command</code> <code>=
summary:<a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>
<span>-&gt;</span> ?⁠readme:(<a href=
"../Core_kernel__/Import/index.html#type-unit">Core_kernel__.Import.unit</a>
<span>-&gt;</span> <a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>)
<span>-&gt;</span> (<a href=
"../Core_kernel__/Import/index.html#type-unit">Core_kernel__.Import.unit</a>
<span>-&gt;</span> <span class="type-var">'result</span>) <a href=
"Param/index.html#type-t">Param.t</a> <span>-&gt;</span> <a href=
"index.html#type-t">t</a></code></dt>
</dl>
<dl>
<dt class="spec value" id="val-basic"><a href="#val-basic" class=
"anchor"></a><code><span class="keyword">val</span> basic :
<a href="../Core_kernel__/Import/index.html#type-unit">Core_kernel__.Import.unit</a>
<a href=
"index.html#type-basic_command">basic_command</a></code></dt>
<dd>
<p>Same general behavior as <code>basic_spec</code>, but takes a
command line specification built up using <code>Params</code>
instead of <code>Spec</code>.</p>
</dd>
</dl>
<dl>
<dt class="spec value" id="val-group"><a href="#val-group" class=
"anchor"></a><code><span class="keyword">val</span> group :
summary:<a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>
<span>-&gt;</span> ?⁠readme:(<a href=
"../Core_kernel__/Import/index.html#type-unit">Core_kernel__.Import.unit</a>
<span>-&gt;</span> <a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>)
<span>-&gt;</span> ?⁠preserve_subcommand_order:<a href=
"../Core_kernel__/Import/index.html#type-unit">Core_kernel__.Import.unit</a>
<span>-&gt;</span> ?⁠body:(path:<a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>
<a href=
"../Core_kernel__/Import/index.html#type-list">Core_kernel__.Import.list</a>
<span>-&gt;</span> <a href=
"../Core_kernel__/Import/index.html#type-unit">Core_kernel__.Import.unit</a>)
<span>-&gt;</span> (<a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>
* <a href="index.html#type-t">t</a>) <a href=
"../Core_kernel__/Import/index.html#type-list">Core_kernel__.Import.list</a>
<span>-&gt;</span> <a href="index.html#type-t">t</a></code></dt>
<dd>
<p><code>group ~summary subcommand_alist</code> is a compound
command with named subcommands, as found in
<code>subcommand_alist</code>. <code>summary</code> is to contain a
short one-line description of the command group.
<code>readme</code> is to contain any longer description of its
behavior that will go on that command's help screen.</p>
<p>NOTE: subcommand names containing underscores will be rejected;
use dashes instead.</p>
<p><code>body</code> is called when no additional arguments are
passed -- in particular, when no subcommand is passed. Its
<code>path</code> argument is the subcommand path by which the
group command was reached.</p>
</dd>
</dl>
<dl>
<dt class="spec value" id="val-lazy_group"><a href=
"#val-lazy_group" class="anchor"></a><code><span class=
"keyword">val</span> lazy_group : summary:<a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>
<span>-&gt;</span> ?⁠readme:(<a href=
"../Core_kernel__/Import/index.html#type-unit">Core_kernel__.Import.unit</a>
<span>-&gt;</span> <a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>)
<span>-&gt;</span> ?⁠preserve_subcommand_order:<a href=
"../Core_kernel__/Import/index.html#type-unit">Core_kernel__.Import.unit</a>
<span>-&gt;</span> ?⁠body:(path:<a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>
<a href=
"../Core_kernel__/Import/index.html#type-list">Core_kernel__.Import.list</a>
<span>-&gt;</span> <a href=
"../Core_kernel__/Import/index.html#type-unit">Core_kernel__.Import.unit</a>)
<span>-&gt;</span> (<a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>
* <a href="index.html#type-t">t</a>) <a href=
"../Core_kernel__/Import/index.html#type-list">Core_kernel__.Import.list</a>
<a href=
"../Core_kernel/Lazy/index.html#type-t">Core_kernel.Lazy.t</a>
<span>-&gt;</span> <a href="index.html#type-t">t</a></code></dt>
<dd>
<p><code>lazy_group</code> is the same as <code>group</code>,
except that the list of subcommands may be generated lazily.</p>
</dd>
</dl>
<dl>
<dt class="spec value" id="val-exec"><a href="#val-exec" class=
"anchor"></a><code><span class="keyword">val</span> exec :
summary:<a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>
<span>-&gt;</span> ?⁠readme:(<a href=
"../Core_kernel__/Import/index.html#type-unit">Core_kernel__.Import.unit</a>
<span>-&gt;</span> <a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>)
<span>-&gt;</span> ?⁠child_subcommand:<a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>
<a href=
"../Core_kernel__/Import/index.html#type-list">Core_kernel__.Import.list</a>
<span>-&gt;</span> path_to_exe:[ `Absolute of <a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>
| `Relative_to_argv0 of <a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>
| `Relative_to_me of <a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a>
] <span>-&gt;</span> <a href=
"../Core_kernel__/Import/index.html#type-unit">Core_kernel__.Import.unit</a>
<span>-&gt;</span> <a href="index.html#type-t">t</a></code></dt>
<dd>
<p><code>exec ~summary ~path_to_exe</code> runs <code>exec</code>
on the executable at <code>path_to_exe</code>. If
<code>path_to_exe</code> is <code>`Absolute path</code> then
<code>path</code> is executed without any further qualification. If
it is <code>`Relative_to_me path</code> then <code>Filename.dirname
Sys.executable_name ^ "/" ^ path</code> is executed instead. All of
the usual caveats about <code>Sys.executable_name</code> apply:
specifically, it may only return an absolute path in Linux. On
other operating systems it will return <code>Sys.argv.(0)</code>.
If it is <code>`Relative_to_argv0 path</code> then
<code>Sys.argv.(0) ^ "/" ^ path</code> is executed.</p>
<p>The <code>child_subcommand</code> argument allows referencing a
subcommand one or more levels below the top-level of the child
executable. It should <em>not</em> be used to pass flags or
anonymous arguments to the child.</p>
<p>Care has been taken to support nesting multiple executables
built with Command. In particular, recursive help and
autocompletion should work as expected.</p>
<p>NOTE: Non-Command executables can be used with this function but
will still be executed when <code>help -recursive</code> is called
or autocompletion is attempted (despite the fact that neither will
be particularly helpful in this case). This means that if you have
a shell script called "reboot-everything.sh" that takes no
arguments and reboots everything no matter how it is called, you
shouldn't use it with <code>exec</code>.</p>
<p>Additionally, no loop detection is attempted, so if you nest an
executable within itself, <code>help -recursive</code> and
autocompletion will hang forever (although actually running the
subcommand will work).</p>
</dd>
</dl>
<dl>
<dt class="spec value" id="val-of_lazy"><a href="#val-of_lazy"
class="anchor"></a><code><span class="keyword">val</span> of_lazy :
<a href="index.html#type-t">t</a> <a href=
"../Core_kernel/Lazy/index.html#type-t">Core_kernel.Lazy.t</a>
<span>-&gt;</span> <a href="index.html#type-t">t</a></code></dt>
<dd>
<p><code>of_lazy thunk</code> constructs a lazy command that is
forced only when necessary to run it or extract its shape.</p>
</dd>
</dl>
<dl>
<dt class="spec value" id="val-summary"><a href="#val-summary"
class="anchor"></a><code><span class="keyword">val</span> summary :
<a href="index.html#type-t">t</a> <span>-&gt;</span> <a href=
"../Core_kernel__/Import/index.html#type-string">Core_kernel__.Import.string</a></code></dt>
<dd>
<p>Extracts the summary string for a command.</p>
</dd>
</dl>
<div class="spec module" id="module-Shape"><a href="#module-Shape"
class="anchor"></a><code><span class="keyword">module</span>
<a href="Shape/index.html">Shape</a> : <span class=
"keyword">sig</span> ... <span class=
"keyword">end</span></code></div>
<dl>
<dt class="spec module" id="module-Deprecated"><a href=
"#module-Deprecated" class="anchor"></a><code><span class=
"keyword">module</span> <a href=
"Deprecated/index.html">Deprecated</a> : <span class=
"keyword">sig</span> ... <span class=
"keyword">end</span></code></dt>
<dd>
<p><code>Deprecated</code> should be used only by
<code>Deprecated_command</code>. At some point it will go away.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
</body>
</html>
